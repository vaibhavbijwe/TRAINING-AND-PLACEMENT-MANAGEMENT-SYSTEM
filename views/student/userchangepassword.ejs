<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Setting Change Password</title>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <!-- Font Awesome icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
      integrity="sha512-CfhOTIaTQ6UACsn6UaD6Ia38klxNRmz0iJfTmJKzTki0lTUDrOgzrZbq3mX9ygI+RCmR8hxOg6BcdD2B2LKVHg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Custom CSS -->
    <style>
      /* Sidenav bar */
      .sidenav {
        height: 100%;
        width: 200px;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        background-color: #333;
        overflow-x: hidden;
        padding-top: 20px;
      }
      /* Sidenav links */
      .sidenav a {
        padding: 6px 8px 6px 16px;
        text-decoration: none;
        font-size: 18px;
        color: #f1f1f1;
        display: block;
      }
      /* Sidenav active link */
      .active {
        background-color: #4caf50;
        color: white;
      }
      /* Main content */
      .main {
        margin-left: 200px; /* Same width as the sidebar */
        padding: 20px;
      }
    </style>
  </head>
  <body>
    <!-- Sidenav bar -->
    <div class="sidenav">
      <div class="sidenav">
        <a href="/user/setting"><i class="fas fa-users"></i>User Settings</a>
        <a href="/user/changepass"class="active"><i class="fas fa-users"></i> Change Password</a>
        <a href="/user/home"><i class="fas fa-tasks"></i> Back </a>
      </div>
    </div>
    <!-- Main content -->
    <div class="main">
      <h3>Settings</h3>
      <hr />
          <div class="main">
          <div class="container">
              <div class="row">
        <div class="col-md-6 mx-auto">
       <h2>Change Password</h2>
        <form id="changePasswordForm" action="/user/changepass/<%= user._id%>" method="post" novalidate>

        <div class="row">
          <div class="col-md-8 form-group">
            <label for="currentPassword">Current Password</label>
            <input type="password" class="form-control" id="currentPassword" name="currentPassword" required>
            <div class="invalid-feedback">Please enter your current password.</div>
            </div>
          </div>
     <div class="row">
      <div class="col-md-8 form-group">
        <!-- New Password -->
        <label for="newPassword">New Password</label>
        <input type="password" class="form-control" id="newPassword" name="newPassword" required>
        <div class="invalid-feedback">Please enter a new password.</div>
      </div>
      </div>
       <div class="row">
      <div class="col-md-8 form-group">
        <!-- Re-enter New Password -->
        <label for="reenterNewPassword">Re-enter New Password</label>
        <input type="password" class="form-control" id="reenterNewPassword" name="reenterNewPassword" required>
        <div class="invalid-feedback">Please re-enter your new password.</div>
        <div id="passwordMismatch" class="text-danger d-none">Passwords do not match.</div>
      </div>
      </div>
    <div class="text-center mt-3">
    <button type="submit" class="btn btn-primary">Change Password</button>
</div>
  </form><br>
  <% 
  if(typeof message !== "undefined"){
      %>
      <p style="color:red;"> <%= message %> </p>
      <%
  }

%>
  </div>
  </div>
</div>

            
          </div>
        </div>
      </div>
    </div>
    <!-- Bootstrap JavaScript -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script>
      // Get the form element
      const changePasswordForm = document.getElementById('changePasswordForm');
  
      // Add a submit event listener to the form
      changePasswordForm.addEventListener('submit', function(event) {
        // Prevent the default form submission behavior
        event.preventDefault();
  
        // Get the values of the input fields
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const reenterNewPassword = document.getElementById('reenterNewPassword').value;
  
        // Check if the new password and the re-entered password match
        if (newPassword !== reenterNewPassword) {
          document.getElementById('passwordMismatch').classList.remove('d-none');
          return;
        }
  
        // If the passwords match, submit the form
        this.submit();
      });
  
      // Add a change event listener to the re-entered password input field
      const reenterNewPassword = document.getElementById('reenterNewPassword');
      reenterNewPassword.addEventListener('input', function() {
        // Hide the password mismatch error message when the user starts typing in the re-entered password field
        document.getElementById('passwordMismatch').classList.add('d-none');
      });
    </script>
  </body>
</html>
